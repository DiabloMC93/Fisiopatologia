<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Examen de Fisiología</title>
    <style>
        :root {
            --primary: #3b82f6; /* Azul moderno */
            --primary-dark: #2563eb;
            --success: #10b981; /* Verde esmeralda */
            --error: #ef4444; /* Rojo suave */
            --bg: #f8fafc; /* Gris muy claro */
            --card: #ffffff;
            --text-main: #1e293b;
            --text-sec: #64748b;
        }

        body {
            font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
            background-color: var(--bg);
            color: var(--text-main);
            margin: 0;
            padding: 0;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        /* Contenedor Principal (Tarjeta) */
        .app-container {
            background-color: var(--card);
            width: 100%;
            max-width: 700px;
            min-height: 500px; /* Altura mínima para consistencia */
            margin: 20px;
            border-radius: 16px;
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1), 0 8px 10px -6px rgba(0, 0, 0, 0.01);
            display: flex;
            flex-direction: column;
            overflow: hidden;
            position: relative;
        }

        /* Cabecera con estadísticas */
        .header {
            background-color: white;
            padding: 20px 30px;
            border-bottom: 1px solid #e2e8f0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .counters {
            display: flex;
            gap: 15px;
            font-size: 0.95rem;
            font-weight: 600;
        }

        .counter-item {
            display: flex;
            align-items: center;
            gap: 6px;
            padding: 6px 12px;
            border-radius: 20px;
        }

        .c-correct { background-color: #d1fae5; color: #065f46; }
        .c-wrong { background-color: #fee2e2; color: #991b1b; }
        
        /* Barra de progreso */
        .progress-container {
            width: 100%;
            height: 6px;
            background-color: #e2e8f0;
        }
        .progress-bar {
            height: 100%;
            background-color: var(--primary);
            width: 0%;
            transition: width 0.4s ease;
        }

        /* Área de contenido (Preguntas) */
        .content-area {
            padding: 40px;
            flex-grow: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
            
            /* Animación de entrada */
            animation: fadeIn 0.5s ease-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .question-number {
            color: var(--text-sec);
            text-transform: uppercase;
            letter-spacing: 1px;
            font-size: 0.85rem;
            font-weight: 700;
            margin-bottom: 15px;
        }

        .question-text {
            font-size: 1.4rem;
            font-weight: 600;
            line-height: 1.5;
            margin-bottom: 30px;
            color: var(--text-main);
        }

        .options-list {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .option-btn {
            background: white;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            padding: 18px 20px;
            text-align: left;
            font-size: 1rem;
            color: var(--text-main);
            cursor: pointer;
            transition: all 0.2s ease;
            position: relative;
            display: flex; /* Para alinear letra y texto */
            gap: 10px;
        }

        .option-letter {
            font-weight: bold;
            color: var(--primary);
            min-width: 25px; /* Ancho fijo para alineación */
        }

        .option-btn:hover:not(:disabled) {
            border-color: var(--primary);
            background-color: #eff6ff;
            transform: translateY(-2px);
        }

        .option-btn:disabled {
            cursor: default;
            opacity: 0.7;
        }

        /* Estilos de validación */
        .option-btn.correct {
            border-color: var(--success);
            background-color: #d1fae5;
            color: #065f46;
            font-weight: 600;
        }
        
        .option-btn.correct .option-letter {
            color: #065f46; /* Cambiar color letra en acierto */
        }
        
        .option-btn.correct::after {
            content: "✓";
            position: absolute;
            right: 20px;
            font-weight: bold;
        }

        .option-btn.wrong {
            border-color: var(--error);
            background-color: #fee2e2;
            color: #991b1b;
        }

        .option-btn.wrong .option-letter {
            color: #991b1b;
        }
        
        .option-btn.wrong::after {
            content: "✕";
            position: absolute;
            right: 20px;
            font-weight: bold;
        }

        /* Botón Siguiente */
        .footer-controls {
            padding: 20px 40px;
            border-top: 1px solid #e2e8f0;
            display: flex;
            justify-content: flex-end;
            background-color: #f8fafc;
        }

        .next-btn {
            background-color: var(--primary);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: background 0.2s;
            display: none; /* Oculto hasta responder */
        }

        .next-btn:hover {
            background-color: var(--primary-dark);
        }

        /* Pantalla de Resultados */
        .results-screen {
            text-align: center;
            padding: 30px 20px;
            display: none; /* Oculto inicialmente */
        }

        .score-circle {
            width: 160px;
            height: 160px;
            background: conic-gradient(var(--primary) 0%, #e2e8f0 0%);
            border-radius: 50%;
            margin: 0 auto 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }
        
        .score-circle::before {
            content: "";
            width: 140px;
            height: 140px;
            background-color: white;
            border-radius: 50%;
            position: absolute;
        }

        .score-content {
            position: relative;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .score-number {
            font-size: 3rem;
            font-weight: 800;
            color: var(--text-main);
            line-height: 1;
        }
        
        .score-label {
            font-size: 0.9rem;
            color: var(--text-sec);
            font-weight: 600;
            margin-top: 5px;
        }

        .message {
            font-size: 1.3rem;
            color: var(--text-main);
            margin-bottom: 10px;
            font-weight: 600;
        }
        
        .stats-summary {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 30px;
            color: var(--text-sec);
            font-size: 0.95rem;
        }

        .restart-btn {
            background-color: var(--primary);
            color: white;
            padding: 15px 35px;
            border-radius: 12px;
            border: none;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s, background 0.2s;
        }
        
        .restart-btn:hover {
            background-color: var(--primary-dark);
            transform: translateY(-2px);
        }

    </style>
</head>
<body>

<div class="app-container">
    <!-- Barra de progreso superior -->
    <div class="progress-container">
        <div class="progress-bar" id="progress-bar"></div>
    </div>

    <!-- Cabecera -->
    <header class="header" id="app-header">
        <div class="counters">
            <div class="counter-item c-correct">
                <span>Correctas:</span>
                <span id="score-correct">0</span>
            </div>
            <div class="counter-item c-wrong">
                <span>Incorrectas:</span>
                <span id="score-wrong">0</span>
            </div>
        </div>
    </header>

    <!-- Área de Pregunta -->
    <div class="content-area" id="quiz-area">
        <div class="question-number" id="q-number">PREGUNTA 1 DE 40</div>
        <div class="question-text" id="q-text">Cargando...</div>
        <div class="options-list" id="options-list">
            <!-- Botones generados por JS -->
        </div>
    </div>

    <!-- Área de Resultados (oculta al inicio) -->
    <div class="results-screen content-area" id="results-area">
        <h2 style="color: var(--primary); margin-bottom: 20px;">Resultados del Examen</h2>
        
        <div class="score-circle" id="score-circle">
            <div class="score-content">
                <span class="score-number" id="final-grade">0.00</span>
                <span class="score-label">NOTA FINAL</span>
            </div>
        </div>

        <p class="message" id="final-message">Calculando...</p>
        
        <div class="stats-summary">
            <div>✅ <span id="final-correct">0</span> Aciertos (+0.25)</div>
            <div>❌ <span id="final-wrong">0</span> Fallos (-0.08)</div>
        </div>

        <div>
            <button class="restart-btn" onclick="restartQuiz()">Volver a intentar</button>
        </div>
    </div>

    <!-- Controles -->
    <footer class="footer-controls" id="quiz-footer">
        <button class="next-btn" id="next-btn" onclick="nextQuestion()">Siguiente Pregunta &rarr;</button>
    </footer>
</div>

<script>
    // DATOS DE LAS PREGUNTAS (Extraídos del PDF)
    const questions = [
        { q: "En relación con el equilibrio hidrosalino, un déficit de agua:", options: ["Promueve la síntesis de ADH.", "Aumenta la reabsorción de agua por los riñones.", "Estimula la sensación de sed.", "Todas las respuestas son correctas."], correct: 3 },
        { q: "Ausencia focal o general del tejido adiposo:", options: ["Lipoatrofia", "Lipohipertrofia", "Lipogénesis", "Lipomatosis"], correct: 0 },
        { q: "Bacteria responsable de numerosas patologías a nivel de estómago e intestino (úlceras, gastritis, cáncer...):", options: ["Helicobacter pylori", "Escherichia coli", "Streptococcus pyogenes", "Staphylococcus aureus"], correct: 0 },
        { q: "El borde de cepillo o microvellosidades del intestino delgado ayudan a:", options: ["Aumentar la superficie de absorción de los nutrientes.", "Proteger el intestino de bacterias y virus.", "Regular la temperatura interna del cuerpo.", "Producir enzimas digestivas para descomponer los alimentos."], correct: 0 },
        { q: "El componente con mayor peso (60-65%) en el cálculo del gasto energético total es:", options: ["Gasto energético basal (GEB).", "Efecto térmico de los alimentos (ETA).", "Gasto energético por actividad física (GEAF).", "Ninguna es correcta."], correct: 0 },
        { q: "El síndrome de secreción inadecuada de antidiurética (SIADH) consiste en un aumento de la liberación de:", options: ["Vasopresina", "Prolactina", "Hormona tiroidea", "Todas las respuestas son correctas"], correct: 0 },
        { q: "El término leucemia, hace referencia a:", options: ["Un aumento en los niveles de progesterona.", "Un descenso en el número de leucocitos.", "Un aumento en el número de leucocitos.", "Un descenso en los niveles de progesterona."], correct: 2 },
        { q: "En cuanto a la regulación de la síntesis de ácidos grasos, esta es estimulada por:", options: ["Insulina", "Glucagón", "A y B son ciertas.", "A y B son falsas."], correct: 0 },
        { q: "En el control del hambre y la saciedad, el péptido YY:", options: ["Es una señal orexigénica, estimula el apetito.", "Es una señal orexigénica, inhibe el hambre.", "Es una señal anorexigénica, estimula el apetito.", "Es una señal anorexigénica, inhibe el hambre."], correct: 3 },
        { q: "En relación con las alteraciones musculares, la contracción sostenida del músculo se conoce como:", options: ["Tetania", "Mialgia", "Atrofia", "Hipertrofia."], correct: 0 },
        { q: "Enfermedad crónica de tipo autoinmune, que afecta al intestino delgado y que genera intolerancia al gluten:", options: ["Enfermedad celíaca.", "Enfermedad de Whipple.", "Enfermedad de Crohn.", "Enfermedad diverticular."], correct: 0 },
        { q: "Entre las hormonas liberadas por la hipófisis, se encuentra:", options: ["Hormona del crecimiento (GH).", "Prolactina (PRL).", "Hormona corticotropina (ACTH).", "Todas son correctas."], correct: 3 },
        { q: "Entre las inmunodeficiencias primarias, encontramos:", options: ["Inmunodeficiencia combinada severa.", "Déficit selectivo de IgA.", "Inmunodeficiencia variable común.", "Todas son correctas."], correct: 3 },
        { q: "Entre las patologías asociadas a la cavidad oral se encuentra:", options: ["Herpes labial.", "Caries.", "Úlceras bucales.", "Todas son correctas."], correct: 3 },
        { q: "Entre las patologías asociadas al tejido óseo, encontramos:", options: ["Osteomalacia", "Raquitismo", "Enfermedad de Paget", "Todas son correctas."], correct: 3 },
        { q: "Entre las recomendaciones establecidas para pacientes con patología pancreática se encuentra:", options: ["Consumo exógeno de enzimas pancreáticas.", "Consumo de suplementos nutricionales ante posibles pérdidas de peso.", "Consumo moderado de alimentos, evitando comidas copiosas.", "Todas las anteriores son recomendaciones válidas."], correct: 3 },
        { q: "Entre los factores no modificables que influyen en el desarrollo del cáncer, encontramos:", options: ["Mutación hereditaria en el gen BRCA1.", "Consumo de tabaco.", "Exposición a rayos UV.", "Infección por Helicobacter pylori."], correct: 0 },
        { q: "Este valor de glucemia en ayunas indica diabetes:", options: ["Mayor o igual a 76 mg/dL", "Mayor o igual a 126 mg/dL", "Mayor o igual a 200 mg/dL", "Mayor o igual a 376 mg/dL"], correct: 1 },
        { q: "Gasto energético derivado de cualquier movimiento:", options: ["Gasto energético basal (GEB).", "Gasto energético por actividad física (GEAF).", "Efecto térmico de los alimentos (ETA).", "Gasto energético nutritivo (GEN)."], correct: 1 },
        { q: "Indica la relación incorrecta entre la patología y sus consecuencias:", options: ["Alzheimer - Alteración de la memoria", "Escotoma - Alteración visual", "Hipoacusia - Alteración auditiva", "Nistagmo - Alteración del sueño"], correct: 3 },
        { q: "Inmunoglobulina más abundante a nivel sérico, y la principal secretada en respuestas inmunológicas secundarias:", options: ["IgG", "IgD", "IgM", "IgE"], correct: 0 },
        { q: "La aldosterona, el cortisol y la adrenalina son producidos en:", options: ["Los testículos u ovarios.", "El tiroides.", "Las glándulas suprarrenales.", "El paratiroides."], correct: 2 },
        { q: "La anemia se ocasiona por:", options: ["Déficit de hierro", "Déficit de vitamina B12", "Déficit de folato", "Todas las anteriores son posibles causas de anemia."], correct: 3 },
        { q: "La diabetes tipo 2 es una:", options: ["Hipoglucemia de tipo autoinmune.", "Hipoglucemia asociada a hábitos.", "Hiperglucemia de tipo autoinmune.", "Hiperglucemia asociada a hábitos o predisposición genética."], correct: 3 },
        { q: "La energía aportada por cada gramo de macronutriente es:", options: ["HC: 4kcal; Prot: 4kcal; Líp: 9kcal.", "HC: 9kcal; Prot: 4kcal; Líp: 4kcal.", "HC: 4kcal; Prot: 9kcal; Líp: 4kcal.", "HC: 4kcal; Prot: 4kcal; Líp: 4kcal."], correct: 0 },
        { q: "La escala de Glasgow es empleada para:", options: ["Evaluar el nivel de equilibrio de una persona.", "Evaluar el nivel de consciencia de una persona.", "Evaluar la capacidad respiratoria de una persona.", "Evaluar las capacidades de cálculo matemático."], correct: 1 },
        { q: "La gastroparesia es una condición que afecta a:", options: ["El esófago", "El estómago", "La faringe", "La boca"], correct: 1 },
        { q: "La hemocromatosis es una patología caracterizada por la acumulación tisular de:", options: ["Calcio", "Hierro", "Cromo", "Magnesio"], correct: 1 },
        { q: "La insulina se produce en:", options: ["El hígado.", "El páncreas.", "El intestino delgado.", "La vesícula biliar."], correct: 1 },
        { q: "La saliva se caracteriza por la presencia de:", options: ["Amilasas, para digerir carbohidratos.", "Lipasas, para digerir lípidos.", "Proteinasas, para digerir proteínas.", "Ácido clorhídrico."], correct: 0 },
        { q: "Las inmunodeficiencias primarias:", options: ["Son enfermedades derivadas por déficit del sistema inmune desde el nacimiento.", "Son enfermedades de mala función inmune adquirida.", "Se denominan también inmunodeficiencias natales.", "El SIDA es un tipo de inmunodeficiencia primaria."], correct: 0 },
        { q: "Las sales biliares secretadas por el hígado son cruciales para la digestión de:", options: ["Las proteínas", "Los lípidos", "Los hidratos de carbono", "Las vitaminas"], correct: 1 },
        { q: "Los aminoácidos se clasifican habitualmente en dos grupos:", options: ["Esenciales (dieta) y no esenciales (sintetizados).", "Esenciales (animal) y no esenciales (vegetal).", "Esenciales (simples) y no esenciales (externos).", "Esenciales (sintetizados) y no esenciales (dieta)."], correct: 0 },
        { q: "Los jugos gástricos contienen:", options: ["Ácido clorhídrico", "Pepsinógeno", "Bicarbonato", "Todas son correctas."], correct: 3 },
        { q: "Molécula encargada de actuar sobre el hipotálamo para estimular la termogénesis y fiebre:", options: ["Interleuquina 1 (IL-1).", "Interleuquina 6 (IL-6).", "Prostaglandina E2 (PGE2).", "Prostaglandina E3 (PGE3)."], correct: 2 },
        { q: "No es una recomendación orientada a prevenir el cáncer:", options: ["Reducir el consumo de grasas por debajo de un 30%.", "Reducir grasas saturadas por debajo de un 10%.", "Incrementar el consumo de carne roja y procesada.", "Limitar el consumo de alcohol y tabaco."], correct: 2 },
        { q: "Obstrucción irreversible del flujo aéreo por inflamación (humo, contaminantes):", options: ["Asma", "Enfermedad pulmonar obstructiva crónica (EPOC)", "Derrame pleural", "Enfermedad pulmonar intersticial"], correct: 1 },
        { q: "Respuesta fallida, desmesurada o insuficiente del sistema inmune frente a una infección:", options: ["Asepsia", "Sepsis", "Neoplasia", "Síndrome de disfunción de órganos múltiples"], correct: 1 },
        { q: "Se entiende por fiebre un aumento de temperatura corporal superior a:", options: ["30 ºC", "32 ºC", "36 ºC", "38 ºC"], correct: 3 },
        { q: "Su hiperfunción puede ocasionar acromegalia o gigantismo:", options: ["Hormona del crecimiento", "Aldosterona", "Prolactina", "Vasopresina"], correct: 0 }
    ];

    // ESTADO DE LA APLICACIÓN
    let currentIdx = 0;
    let scoreCorrect = 0;
    let scoreWrong = 0;

    // REFERENCIAS AL DOM
    const ui = {
        progressBar: document.getElementById('progress-bar'),
        scoreCorrect: document.getElementById('score-correct'),
        scoreWrong: document.getElementById('score-wrong'),
        qNumber: document.getElementById('q-number'),
        qText: document.getElementById('q-text'),
        optionsList: document.getElementById('options-list'),
        nextBtn: document.getElementById('next-btn'),
        quizArea: document.getElementById('quiz-area'),
        resultsArea: document.getElementById('results-area'),
        appHeader: document.getElementById('app-header'),
        quizFooter: document.getElementById('quiz-footer'),
        finalGrade: document.getElementById('final-grade'),
        scoreCircle: document.getElementById('score-circle'),
        finalMessage: document.getElementById('final-message'),
        finalCorrect: document.getElementById('final-correct'),
        finalWrong: document.getElementById('final-wrong')
    };

    function initQuiz() {
        currentIdx = 0;
        scoreCorrect = 0;
        scoreWrong = 0;
        
        // Reset UI
        ui.resultsArea.style.display = 'none';
        ui.quizArea.style.display = 'flex';
        ui.appHeader.style.display = 'flex';
        ui.quizFooter.style.display = 'flex';
        
        updateStats();
        loadQuestion();
    }

    function updateStats() {
        ui.scoreCorrect.innerText = scoreCorrect;
        ui.scoreWrong.innerText = scoreWrong;
        // Barra de progreso
        const progress = ((currentIdx) / questions.length) * 100;
        ui.progressBar.style.width = `${progress}%`;
    }

    function loadQuestion() {
        // Efecto visual: Pequeño fade in al cargar
        ui.quizArea.style.animation = 'none';
        ui.quizArea.offsetHeight; /* trigger reflow */
        ui.quizArea.style.animation = 'fadeIn 0.5s ease-out';

        const q = questions[currentIdx];
        
        ui.qNumber.innerText = `PREGUNTA ${currentIdx + 1} DE ${questions.length}`;
        ui.qText.innerText = q.q;
        ui.optionsList.innerHTML = '';
        ui.nextBtn.style.display = 'none';

        const letters = ['A.', 'B.', 'C.', 'D.', 'E.', 'F.']; 

        q.options.forEach((opt, index) => {
            const btn = document.createElement('button');
            btn.className = 'option-btn';
            
            const letterSpan = document.createElement('span');
            letterSpan.className = 'option-letter';
            letterSpan.innerText = letters[index] || '';
            
            const textSpan = document.createElement('span');
            textSpan.innerText = opt;

            btn.appendChild(letterSpan);
            btn.appendChild(textSpan);
            
            btn.onclick = () => selectOption(index, btn);
            ui.optionsList.appendChild(btn);
        });

        updateStats();
    }

    function selectOption(selectedIndex, btnElement) {
        if (ui.nextBtn.style.display === 'block') return;

        const q = questions[currentIdx];
        const buttons = ui.optionsList.querySelectorAll('.option-btn');

        buttons.forEach(b => b.disabled = true);

        if (selectedIndex === q.correct) {
            btnElement.classList.add('correct');
            scoreCorrect++;
        } else {
            btnElement.classList.add('wrong');
            buttons[q.correct].classList.add('correct');
            scoreWrong++;
        }

        updateStats();
        ui.nextBtn.style.display = 'block';
        ui.nextBtn.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
    }

    function nextQuestion() {
        currentIdx++;
        if (currentIdx < questions.length) {
            loadQuestion();
        } else {
            showResults();
        }
    }

    function showResults() {
        // Ocultar elementos del quiz
        ui.quizArea.style.display = 'none';
        ui.appHeader.style.display = 'none';
        ui.quizFooter.style.display = 'none';
        ui.progressBar.style.width = '100%';
        
        // Mostrar resultados
        ui.resultsArea.style.display = 'block';
        
        // CÁLCULO DE LA NOTA
        // Acierto = +0.25, Error = -0.08
        // Nota Máxima = 40 * 0.25 = 10
        let rawScore = (scoreCorrect * 0.25) - (scoreWrong * 0.08);
        
        // Evitar notas negativas visuales si se desea, aunque académicamente se mantienen.
        // Aquí mostramos el valor real, pero no bajamos de 0 para el gráfico.
        if (rawScore < 0) rawScore = 0; 

        // Mostrar nota con 2 decimales
        ui.finalGrade.innerText = rawScore.toFixed(2);
        
        // Mostrar desglose
        ui.finalCorrect.innerText = scoreCorrect;
        ui.finalWrong.innerText = scoreWrong;

        // Configurar gráfico circular (basado en porcentaje sobre 10)
        // Nota: Si la nota es 10, es el 100% del círculo.
        const percentage = (rawScore / 10) * 100;
        const color = rawScore >= 5 ? 'var(--success)' : 'var(--error)';
        
        ui.scoreCircle.style.background = `conic-gradient(${color} ${percentage}%, #e2e8f0 ${percentage}%)`;
        ui.finalGrade.style.color = color;

        // Mensaje personalizado basado en la nota sobre 10
        if (rawScore >= 9) {
            ui.finalMessage.innerText = "¡Sobresaliente! Excelente trabajo.";
        } else if (rawScore >= 7) {
            ui.finalMessage.innerText = "¡Notable! Muy buen resultado.";
        } else if (rawScore >= 5) {
            ui.finalMessage.innerText = "Aprobado. Buen esfuerzo.";
        } else {
            ui.finalMessage.innerText = "Suspenso. Necesitas repasar más.";
        }
    }

    function restartQuiz() {
        initQuiz();
    }

    initQuiz();
</script>

</body>
</html>
